#!/bin/bash
#‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# Settings Dmenu - Launch apps from bemenu/dmenu
# With emoji icons and categories
#‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

# Terminal emulator
TERM_CMD="foot"

# Menu command (bemenu for wayland, dmenu for X11)
if command -v bemenu &>/dev/null; then
    MENU="bemenu -i -l 15 -p '‚öô Apps'"
elif command -v dmenu &>/dev/null; then
    MENU="dmenu -i -l 15 -p Apps"
else
    notify-send "Error" "Install bemenu: sudo apt install bemenu"
    exit 1
fi

# Paths
SETTINGS="$HOME/bin/settings"
SETTINGS_HUB="$HOME/bin/settings-hub"

# Build menu
menu_items() {
    echo "‚îÄ‚îÄ‚îÄ üñ• Terminal ‚îÄ‚îÄ‚îÄ"
    command -v nmtui &>/dev/null && echo "        üåê Network (nmtui)"
    command -v nmtui-connect &>/dev/null && echo "        üì∂ WiFi Connect"
    [ -x "$SETTINGS" ] && echo "        ‚öôÔ∏è  Settings"
    [ -x "$SETTINGS_HUB" ] && echo "        üè™ Settings Hub"
    command -v htop &>/dev/null && echo "        üìä htop"
    command -v btop &>/dev/null && echo "        üìà btop"
    command -v nvtop &>/dev/null && echo "        üéÆ nvtop (GPU)"
    command -v nmcli &>/dev/null && echo "        üì° nmcli monitor"
    command -v alsamixer &>/dev/null && echo "        üîä alsamixer"
    command -v pulsemixer &>/dev/null && echo "        üéöÔ∏è  pulsemixer"
    command -v ranger &>/dev/null && echo "        üìÅ ranger"
    command -v mc &>/dev/null && echo "        üìÅ Midnight Commander"
    command -v neofetch &>/dev/null && echo "        üñ•Ô∏è  neofetch"
    command -v cmatrix &>/dev/null && echo "        üü© cmatrix"

    echo "‚îÄ‚îÄ‚îÄ ‚öôÔ∏è  System ‚îÄ‚îÄ‚îÄ"
    command -v gnome-control-center &>/dev/null && echo "        ‚öôÔ∏è  System Settings"
    command -v gnome-software &>/dev/null && echo "        üè™ Software Center"
    command -v snap-store &>/dev/null && echo "        üè™ Snap Store"
    command -v software-properties-gtk &>/dev/null && echo "        üì¶ Software & Updates"
    command -v update-manager &>/dev/null && echo "        üîÑ Software Updater"
    command -v synaptic &>/dev/null && echo "        üì¶ Synaptic"
    command -v gdebi-gtk &>/dev/null && echo "        üì¶ GDebi Package Installer"
    command -v gnome-tweaks &>/dev/null && echo "        üîß GNOME Tweaks"
    command -v dconf-editor &>/dev/null && echo "        üîß DConf Editor"

    echo "‚îÄ‚îÄ‚îÄ üåê Network ‚îÄ‚îÄ‚îÄ"
    command -v nm-connection-editor &>/dev/null && echo "        üåê Network Connections"
    command -v blueman-manager &>/dev/null && echo "        üì∂ Bluetooth"
    command -v gufw &>/dev/null && echo "        üõ°Ô∏è  Firewall"
    command -v wireshark &>/dev/null && echo "        üîç Wireshark"

    echo "‚îÄ‚îÄ‚îÄ üîä Audio & Video ‚îÄ‚îÄ‚îÄ"
    command -v pavucontrol &>/dev/null && echo "        üîä Volume Control"
    command -v pwvucontrol &>/dev/null && echo "        üéõÔ∏è  PipeWire Volume"
    command -v easyeffects &>/dev/null && echo "        üéµ Easy Effects"
    command -v vlc &>/dev/null && echo "        üé¨ VLC"
    command -v mpv &>/dev/null && echo "        üé¨ mpv"
    command -v totem &>/dev/null && echo "        üé¨ Videos"
    command -v rhythmbox &>/dev/null && echo "        üéµ Rhythmbox"
    command -v spotify &>/dev/null && echo "        üéµ Spotify"
    command -v audacity &>/dev/null && echo "        üéôÔ∏è  Audacity"
    command -v obs-studio &>/dev/null && echo "        üìπ OBS Studio"
    command -v kdenlive &>/dev/null && echo "        üé¨ Kdenlive"
    command -v shotcut &>/dev/null && echo "        üé¨ Shotcut"
    command -v handbrake &>/dev/null && echo "        üé¨ HandBrake"
    command -v cheese &>/dev/null && echo "        üì∑ Cheese Webcam"

    echo "‚îÄ‚îÄ‚îÄ üñ•Ô∏è  Display ‚îÄ‚îÄ‚îÄ"
    command -v arandr &>/dev/null && echo "        üñ•Ô∏è  Display Config"
    command -v wdisplays &>/dev/null && echo "        üñ•Ô∏è  Wayland Displays"
    command -v xfce4-power-manager-settings &>/dev/null && echo "        üîã Power Manager"
    command -v lxappearance &>/dev/null && echo "        üé® Appearance"
    command -v qt5ct &>/dev/null && echo "        üé® Qt5 Settings"
    command -v nwg-look &>/dev/null && echo "        üé® GTK Settings"
    command -v nitrogen &>/dev/null && echo "        üñºÔ∏è  Wallpaper"

    echo "‚îÄ‚îÄ‚îÄ üìÅ Files ‚îÄ‚îÄ‚îÄ"
    command -v thunar &>/dev/null && echo "        üìÅ Thunar"
    command -v nautilus &>/dev/null && echo "        üìÅ Files"
    command -v pcmanfm &>/dev/null && echo "        üìÅ PCManFM"
    command -v nemo &>/dev/null && echo "        üìÅ Nemo"
    command -v dolphin &>/dev/null && echo "        üìÅ Dolphin"
    command -v gnome-disks &>/dev/null && echo "        üíæ Disks"
    command -v gparted &>/dev/null && echo "        üíø GParted"
    command -v baobab &>/dev/null && echo "        üìä Disk Usage"
    command -v file-roller &>/dev/null && echo "        üì¶ Archive Manager"

    echo "‚îÄ‚îÄ‚îÄ üñ®Ô∏è  Hardware ‚îÄ‚îÄ‚îÄ"
    command -v system-config-printer &>/dev/null && echo "        üñ®Ô∏è  Printers"
    command -v simple-scan &>/dev/null && echo "        üìÑ Scanner"
    command -v gnome-system-monitor &>/dev/null && echo "        üìä System Monitor"
    command -v stacer &>/dev/null && echo "        üßπ Stacer"
    command -v hardinfo &>/dev/null && echo "        üñ•Ô∏è  Hardware Info"
    command -v cpu-x &>/dev/null && echo "        üñ•Ô∏è  CPU-X"

    echo "‚îÄ‚îÄ‚îÄ üíæ Backup ‚îÄ‚îÄ‚îÄ"
    command -v timeshift &>/dev/null && echo "        üíæ Timeshift"
    command -v deja-dup &>/dev/null && echo "        üíæ Backups"
    command -v seahorse &>/dev/null && echo "        üîë Passwords & Keys"
    command -v keepassxc &>/dev/null && echo "        üîê KeePassXC"

    echo "‚îÄ‚îÄ‚îÄ üåê Internet ‚îÄ‚îÄ‚îÄ"
    command -v firefox &>/dev/null && echo "        ü¶ä Firefox"
    command -v google-chrome &>/dev/null && echo "        üåê Chrome"
    command -v chromium &>/dev/null && echo "        üåê Chromium"
    command -v brave-browser &>/dev/null && echo "        ü¶Å Brave"
    command -v thunderbird &>/dev/null && echo "        üìß Thunderbird"
    command -v geary &>/dev/null && echo "        üìß Geary"
    command -v discord &>/dev/null && echo "        üí¨ Discord"
    command -v telegram-desktop &>/dev/null && echo "        üí¨ Telegram"
    command -v slack &>/dev/null && echo "        üí¨ Slack"
    command -v signal-desktop &>/dev/null && echo "        üí¨ Signal"
    command -v zoom &>/dev/null && echo "        üìπ Zoom"
    command -v teams &>/dev/null && echo "        üìπ Teams"
    command -v transmission-gtk &>/dev/null && echo "        üì• Transmission"
    command -v qbittorrent &>/dev/null && echo "        üì• qBittorrent"
    command -v filezilla &>/dev/null && echo "        üìÇ FileZilla"

    echo "‚îÄ‚îÄ‚îÄ üìù Office ‚îÄ‚îÄ‚îÄ"
    command -v libreoffice &>/dev/null && echo "        üìù LibreOffice"
    command -v libreoffice --writer &>/dev/null && echo "        üìÑ Writer"
    command -v libreoffice --calc &>/dev/null && echo "        üìä Calc"
    command -v libreoffice --impress &>/dev/null && echo "        üìΩÔ∏è  Impress"
    command -v evince &>/dev/null && echo "        üìï Document Viewer"
    command -v okular &>/dev/null && echo "        üìï Okular"
    command -v xournalpp &>/dev/null && echo "        ‚úèÔ∏è  Xournal++"
    command -v calibre &>/dev/null && echo "        üìö Calibre"
    command -v gnome-calendar &>/dev/null && echo "        üìÖ Calendar"
    command -v gnome-calculator &>/dev/null && echo "        üî¢ Calculator"

    echo "‚îÄ‚îÄ‚îÄ üé® Graphics ‚îÄ‚îÄ‚îÄ"
    command -v gimp &>/dev/null && echo "        üé® GIMP"
    command -v inkscape &>/dev/null && echo "        ‚úíÔ∏è  Inkscape"
    command -v krita &>/dev/null && echo "        üé® Krita"
    command -v blender &>/dev/null && echo "        üé¨ Blender"
    command -v darktable &>/dev/null && echo "        üì∑ Darktable"
    command -v rawtherapee &>/dev/null && echo "        üì∑ RawTherapee"
    command -v shotwell &>/dev/null && echo "        üì∑ Shotwell"
    command -v eog &>/dev/null && echo "        üñºÔ∏è  Image Viewer"
    command -v flameshot &>/dev/null && echo "        üì∏ Flameshot"
    command -v peek &>/dev/null && echo "        üìπ Peek (GIF)"

    echo "‚îÄ‚îÄ‚îÄ üíª Development ‚îÄ‚îÄ‚îÄ"
    command -v code &>/dev/null && echo "        üíª VS Code"
    command -v codium &>/dev/null && echo "        üíª VSCodium"
    command -v geany &>/dev/null && echo "        üíª Geany"
    command -v sublime_text &>/dev/null && echo "        üíª Sublime Text"
    command -v atom &>/dev/null && echo "        üíª Atom"
    command -v gedit &>/dev/null && echo "        üìù Text Editor"
    command -v gnome-text-editor &>/dev/null && echo "        üìù Text Editor"
    command -v meld &>/dev/null && echo "        üîÄ Meld"
    command -v gitg &>/dev/null && echo "        üîÄ Gitg"
    command -v github-desktop &>/dev/null && echo "        üêô GitHub Desktop"
    command -v dbeaver &>/dev/null && echo "        üóÑÔ∏è  DBeaver"
    command -v postman &>/dev/null && echo "        üìÆ Postman"

    echo "‚îÄ‚îÄ‚îÄ ‚ö° Engineering ‚îÄ‚îÄ‚îÄ"
    command -v kicad &>/dev/null && echo "        ‚ö° KiCad"
    command -v freecad &>/dev/null && echo "        üîß FreeCAD"
    command -v openscad &>/dev/null && echo "        üîß OpenSCAD"
    command -v prusa-slicer &>/dev/null && echo "        üñ®Ô∏è  PrusaSlicer"
    command -v cura &>/dev/null && echo "        üñ®Ô∏è  Cura"
    command -v arduino &>/dev/null && echo "        üîå Arduino IDE"
    command -v fritzing &>/dev/null && echo "        üîå Fritzing"
    command -v gqrx &>/dev/null && echo "        üìª Gqrx SDR"
    command -v octave &>/dev/null && echo "        üìê Octave"
    command -v matlab &>/dev/null && echo "        üìê MATLAB"

    echo "‚îÄ‚îÄ‚îÄ üéÆ Games ‚îÄ‚îÄ‚îÄ"
    command -v steam &>/dev/null && echo "        üéÆ Steam"
    command -v lutris &>/dev/null && echo "        üéÆ Lutris"
    command -v heroic &>/dev/null && echo "        üéÆ Heroic Launcher"
    command -v retroarch &>/dev/null && echo "        üéÆ RetroArch"

    echo "‚îÄ‚îÄ‚îÄ üñ•Ô∏è  Virtualization ‚îÄ‚îÄ‚îÄ"
    command -v virt-manager &>/dev/null && echo "        üñ•Ô∏è  Virtual Machine Manager"
    command -v virtualbox &>/dev/null && echo "        üñ•Ô∏è  VirtualBox"
    command -v vmware &>/dev/null && echo "        üñ•Ô∏è  VMware"
    command -v gnome-boxes &>/dev/null && echo "        üñ•Ô∏è  Boxes"

    echo "‚îÄ‚îÄ‚îÄ ‚èª Power ‚îÄ‚îÄ‚îÄ"
    echo "        üö™ Logout"
    echo "        ‚ôªÔ∏è  Restart"
    echo "        ‚èª Shutdown"
}

# Get selection
CHOICE=$(menu_items | $MENU)

# Exit if cancelled
[ -z "$CHOICE" ] && exit 0

# Launch based on selection
case "$CHOICE" in
    # Terminal apps
    *"Network (nmtui)"*)    $TERM_CMD nmtui ;;
    *"WiFi Connect"*)       $TERM_CMD nmtui-connect ;;
    *"Settings Hub"*)       $TERM_CMD "$SETTINGS_HUB" ;;
    *"‚öôÔ∏è  Settings"*)       $TERM_CMD "$SETTINGS" ;;
    *"htop"*)               $TERM_CMD htop ;;
    *"btop"*)               $TERM_CMD btop ;;
    *"nvtop"*)              $TERM_CMD nvtop ;;
    *"nmcli monitor"*)      $TERM_CMD nmcli monitor ;;
    *"alsamixer"*)          $TERM_CMD alsamixer ;;
    *"pulsemixer"*)         $TERM_CMD pulsemixer ;;
    *"ranger"*)             $TERM_CMD ranger ;;
    *"Midnight Commander"*) $TERM_CMD mc ;;
    *"neofetch"*)           $TERM_CMD bash -c 'neofetch; read' ;;
    *"cmatrix"*)            $TERM_CMD cmatrix ;;

    # System
    *"System Settings"*)    gnome-control-center & ;;
    *"Software Center"*)    gnome-software & ;;
    *"Snap Store"*)         snap-store & ;;
    *"Software & Updates"*) software-properties-gtk & ;;
    *"Software Updater"*)   update-manager & ;;
    *"Synaptic"*)           synaptic-pkexec & ;;
    *"GDebi"*)              gdebi-gtk & ;;
    *"GNOME Tweaks"*)       gnome-tweaks & ;;
    *"DConf Editor"*)       dconf-editor & ;;

    # Network
    *"Network Connections"*) nm-connection-editor & ;;
    *"Bluetooth"*)          blueman-manager & ;;
    *"Firewall"*)           gufw & ;;
    *"Wireshark"*)          wireshark & ;;

    # Audio & Video
    *"Volume Control"*)     pavucontrol & ;;
    *"PipeWire Volume"*)    pwvucontrol & ;;
    *"Easy Effects"*)       easyeffects & ;;
    *"VLC"*)                vlc & ;;
    *"mpv"*)                mpv --player-operation-mode=pseudo-gui & ;;
    *"Videos"*)             totem & ;;
    *"Rhythmbox"*)          rhythmbox & ;;
    *"Spotify"*)            spotify & ;;
    *"Audacity"*)           audacity & ;;
    *"OBS Studio"*)         obs & ;;
    *"Kdenlive"*)           kdenlive & ;;
    *"Shotcut"*)            shotcut & ;;
    *"HandBrake"*)          ghb & ;;
    *"Cheese"*)             cheese & ;;

    # Display
    *"Display Config"*)     arandr & ;;
    *"Wayland Displays"*)   wdisplays & ;;
    *"Power Manager"*)      xfce4-power-manager-settings & ;;
    *"Appearance"*)         lxappearance & ;;
    *"Qt5 Settings"*)       qt5ct & ;;
    *"GTK Settings"*)       nwg-look & ;;
    *"Wallpaper"*)          nitrogen & ;;

    # Files
    *"Thunar"*)             thunar & ;;
    *"üìÅ Files"*)           nautilus & ;;
    *"PCManFM"*)            pcmanfm & ;;
    *"Nemo"*)               nemo & ;;
    *"Dolphin"*)            dolphin & ;;
    *"Disks"*)              gnome-disks & ;;
    *"GParted"*)            gparted & ;;
    *"Disk Usage"*)         baobab & ;;
    *"Archive Manager"*)    file-roller & ;;

    # Hardware
    *"Printers"*)           system-config-printer & ;;
    *"Scanner"*)            simple-scan & ;;
    *"System Monitor"*)     gnome-system-monitor & ;;
    *"Stacer"*)             stacer & ;;
    *"Hardware Info"*)      hardinfo & ;;
    *"CPU-X"*)              cpu-x & ;;

    # Backup
    *"Timeshift"*)          timeshift-launcher & ;;
    *"üíæ Backups"*)         deja-dup & ;;
    *"Passwords & Keys"*)   seahorse & ;;
    *"KeePassXC"*)          keepassxc & ;;

    # Internet
    *"Firefox"*)            firefox & ;;
    *"Chrome"*)             google-chrome & ;;
    *"Chromium"*)           chromium & ;;
    *"Brave"*)              brave-browser & ;;
    *"Thunderbird"*)        thunderbird & ;;
    *"Geary"*)              geary & ;;
    *"Discord"*)            discord & ;;
    *"Telegram"*)           telegram-desktop & ;;
    *"Slack"*)              slack & ;;
    *"Signal"*)             signal-desktop & ;;
    *"Zoom"*)               zoom & ;;
    *"Teams"*)              teams & ;;
    *"Transmission"*)       transmission-gtk & ;;
    *"qBittorrent"*)        qbittorrent & ;;
    *"FileZilla"*)          filezilla & ;;

    # Office
    *"üìù LibreOffice"*)     libreoffice & ;;
    *"Writer"*)             libreoffice --writer & ;;
    *"Calc"*)               libreoffice --calc & ;;
    *"Impress"*)            libreoffice --impress & ;;
    *"Document Viewer"*)    evince & ;;
    *"Okular"*)             okular & ;;
    *"Xournal++"*)          xournalpp & ;;
    *"Calibre"*)            calibre & ;;
    *"Calendar"*)           gnome-calendar & ;;
    *"Calculator"*)         gnome-calculator & ;;

    # Graphics
    *"GIMP"*)               gimp & ;;
    *"Inkscape"*)           inkscape & ;;
    *"Krita"*)              krita & ;;
    *"Blender"*)            blender & ;;
    *"Darktable"*)          darktable & ;;
    *"RawTherapee"*)        rawtherapee & ;;
    *"Shotwell"*)           shotwell & ;;
    *"Image Viewer"*)       eog & ;;
    *"Flameshot"*)          flameshot gui & ;;
    *"Peek"*)               peek & ;;

    # Development
    *"VS Code"*)            code & ;;
    *"VSCodium"*)           codium & ;;
    *"Geany"*)              geany & ;;
    *"Sublime Text"*)       sublime_text & ;;
    *"Atom"*)               atom & ;;
    *"Text Editor"*)        gnome-text-editor & || gedit & ;;
    *"Meld"*)               meld & ;;
    *"Gitg"*)               gitg & ;;
    *"GitHub Desktop"*)     github-desktop & ;;
    *"DBeaver"*)            dbeaver & ;;
    *"Postman"*)            postman & ;;

    # Engineering
    *"KiCad"*)              kicad & ;;
    *"FreeCAD"*)            freecad & ;;
    *"OpenSCAD"*)           openscad & ;;
    *"PrusaSlicer"*)        prusa-slicer & ;;
    *"Cura"*)               cura & ;;
    *"Arduino"*)            arduino & ;;
    *"Fritzing"*)           fritzing & ;;
    *"Gqrx"*)               gqrx & ;;
    *"Octave"*)             octave --gui & ;;
    *"MATLAB"*)             matlab & ;;

    # Games
    *"Steam"*)              steam & ;;
    *"Lutris"*)             lutris & ;;
    *"Heroic"*)             heroic & ;;
    *"RetroArch"*)          retroarch & ;;

    # Virtualization
    *"Virtual Machine Manager"*) virt-manager & ;;
    *"VirtualBox"*)         virtualbox & ;;
    *"VMware"*)             vmware & ;;
    *"Boxes"*)              gnome-boxes & ;;

    # Power
    *"Logout"*)             swaymsg exit ;;
    *"Restart"*)            systemctl reboot ;;
    *"Shutdown"*)           systemctl poweroff ;;
esac
